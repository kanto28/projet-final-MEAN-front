<div class="container mt-4">
  <h2>Sélectionnez votre véhicule</h2>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>

    <!-- À l'intérieur de votre formulaire principal -->
<form [formGroup]="rendezVousForm" (ngSubmit)="onSubmit()">
  
    <!-- Sélection du véhicule (existant) -->
    <div class="mb-3">
      <label class="form-label">Véhicule</label>
      <select formControlName="vehicule" class="form-select">
        <option value="" disabled>Sélectionnez un véhicule</option>
        <option *ngFor="let v of vehicules" [value]="v._id">
          {{ v.matricule }} - {{ v.model?.nom }} ({{ v.annees }})
        </option>
      </select>
    </div>
  
    <!-- Champ Mvola - Nouveau -->
    <div class="mb-3">
      <label class="form-label">Numéro Mvola</label>
      <input 
        type="tel"
        formControlName="Mvola"
        class="form-control"
        placeholder="0321234567"
        [class.is-invalid]="rendezVousForm.get('Mvola')?.invalid && (rendezVousForm.get('Mvola')?.dirty || rendezVousForm.get('Mvola')?.touched)">
  
      <!-- Messages d'erreur -->
      <div *ngIf="rendezVousForm.get('Mvola')?.hasError('required') && (rendezVousForm.get('Mvola')?.dirty || rendezVousForm.get('Mvola')?.touched)" 
           class="invalid-feedback">
        Le numéro Mvola est obligatoire
      </div>
      <div *ngIf="rendezVousForm.get('Mvola')?.hasError('pattern') && (rendezVousForm.get('Mvola')?.dirty || rendezVousForm.get('Mvola')?.touched)" 
           class="invalid-feedback">
        Format invalide (doit commencer par 032-039 et contenir 10 chiffres)
      </div>
    </div>

    <!-- Après le champ Mvola -->

    <div class="prestations-container">
        <div *ngFor="let prestation of prestationsDisponibles" class="form-check mb-2">
          <input class="form-check-input" 
                 type="checkbox"
                 [checked]="isPrestationSelected(prestation._id)"
                 (change)="onCheckboxChange($event, prestation._id)"
                 [id]="'presta-'+prestation._id">
          
          <label class="form-check-label" [for]="'presta-'+prestation._id">
            {{ prestation.name }}
            <span class="badge bg-primary ms-2">
              {{ prestation.currentPrice | currency:'Ar':'symbol':'1.0-0' }}
            </span>
          </label>
          
          <small class="d-block text-muted">{{ prestation.description }}</small>
        </div>
      </div>
  
  <!-- Avant le bouton de soumission -->
  
    <button type="submit" class="btn btn-primary" [disabled]="rendezVousForm.invalid">
      Confirmer
    </button>
  </form>
  

    <div *ngIf="vehicules.length === 0" class="alert alert-info">
      Aucun véhicule enregistré. Veuillez d'abord ajouter un véhicule.
    </div>
  </div>

  