<div class="card p-4 shadow-lg rounded-lg">
  <div class="card-header text-center mb-4">
    <h3 class="text-xl font-bold">Ajouter une Nouvelle Pièce</h3>
  </div>
  <div class="card-body">
    <form (ngSubmit)="onSubmit()" [formGroup]="pieceForm" class="space-y-4">
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="field">
          <label for="nom" class="font-semibold">Nom</label>
          <input id="nom" type="text" pInputText formControlName="nom" class="w-full" />
          <small *ngIf="pieceForm.get('nom')?.invalid && pieceForm.get('nom')?.touched" class="text-red-500">
            Le nom est requis
          </small>
        </div>

        <div class="field">
          <label for="annees" class="font-semibold">Année</label>
          <input id="annees" type="text" pInputText formControlName="annees" maxlength="4" class="w-full" />
          <small *ngIf="pieceForm.get('annees')?.invalid && pieceForm.get('annees')?.touched" class="text-red-500">
            Maximum 4 caractères
          </small>
        </div>

        <div class="field">
          <label for="model" class="font-semibold">Modèle</label>
          <p-select [options]="models" formControlName="model" optionLabel="name" optionValue="_id" placeholder="Sélectionnez un modèle" class="w-full"></p-select>
          <small *ngIf="pieceForm.get('model')?.invalid && pieceForm.get('model')?.touched" class="text-red-500">
            Le modèle est requis
          </small>
        </div>

        <div class="field">
          <label for="prix" class="font-semibold">Prix initial</label>
          <input id="prix" type="number" pInputText formControlName="prix" class="w-full" />
          <small *ngIf="pieceForm.get('prix')?.invalid && pieceForm.get('prix')?.touched" class="text-red-500">
            Le prix est requis
          </small>
        </div>

        <div class="field col-span-2">
          <label for="prestation" class="font-semibold">Prestation associée</label>
          <p-select [options]="prestations" formControlName="prestationId" optionLabel="name" optionValue="_id" placeholder="Sélectionnez une prestation" class="w-full"></p-select>
          <small *ngIf="pieceForm.get('prestationId')?.invalid && pieceForm.get('prestationId')?.touched" class="text-red-500">
            La prestation est requise
          </small>
        </div>
      </div>
      
      <div class="flex justify-end gap-3 mt-4">
        <button pButton pRipple type="button" label="Annuler" class="p-button-secondary" (click)="onCancel()"></button>
        <button pButton pRipple type="submit" label="Valider" [disabled]="pieceForm.invalid" class="p-button-primary"></button>
      </div>
    </form>

    <!-- Affichage des messages -->
    <p-toast></p-toast>
    <div *ngIf="errorMessage" class="mt-4 p-3 bg-red-100 text-red-700 border border-red-300 rounded">
      <strong>Erreur :</strong> {{ errorMessage }}
    </div>
  </div>
</div>